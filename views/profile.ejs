<!DOCTYPE html>
<html ng-app="Loggedin">
<head>
<title>Result</title>
</head>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js">
	
</script>
<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js">
	
</script>
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.9/angular.min.js"></script>
<script
	src="http://ajax.googleapis.com/ajax/libs/angularjs/1.2.1/angular-sanitize.min.js"></script>


<style>
.center {
	margin-left: auto;
	margin-right: auto;
	width: 400px;
	font-size: 130%;
}
</style>
<body style="margin-top: 0px; background-color: #F5F8FA"
	ng-controller="ProfileCtrl">

	<div class="row"
		style="width: 101%; background-color: white; height: 4rem; ">
		<div
			style="width: 30%; float: left; margin-left: 2rem; margin-top: 0.5rem">
			<a href="/home"> <span class="glyphicon glyphicon-home"
				style="font-size: 18px">Home </span></a>
		</div>
		<div style="width: 20%; float: left; text-align: right">
			<img src="/images/logo.png" alt="Twitter Bird"
				style="height: 30px; width: 30px;">

		</div>
		<div
			style="width: 20%; float: left; text-align: right; margin-left: 15rem">
			<input id="searchText" ng-model="searchText" placeholder="Search Twitter"
				style="moz-border-radius: 15px; border-radius: 15px; padding: 5px; float: left" />
			<button id="search" ng-click="searchmembers(searchText)"
				style="border-style: none; height: 30px; width: 40px; float: left;"
				class="glyphicon glyphicon-search"></button>
		</div>
		<div style="width: 15%; float: right;">
			<button id="Profile" ng-click=""
				style="float: left; background-color: #0084B4; height: 30px; width: 70px; float: left; margin-top: 0.25rem;"
				class="btn btn-primary">Profile</button>

			<button id="logout" ng-click="logout()"
				style="margin-left: 3rem; float: right; background-color: #0084B4; height: 30px; width: 70px; float: left; margin-top: 0.25rem"
				class="btn btn-primary">Logout</button>


		</div>
		<br> <br>

		<div
			style="width: 100%; height: 20rem; float: left; background-color: #0084B4">
		</div>
		<div style="width: 100%; float: left;">
			<div style="width: 5%; height: 90%; float: left;"></div>
			<div id="userImg"
				style="float: left; width: 30%; height: 100%; text-align: center; margin-top: -8rem">
				<img src="/images/NoImg.PNG" alt="No Image" height="180" width="180">
			</div>
			<div
				style="width: 100%; height: 5rem; background-color: white; border-color: solid">

				<table>
					<tr>
						<td id="numTweets" style="width: 33%;">Tweets</td>
						<td id="Following" style="width: 33%;">Following</td>
						<td id="Followers" style="width: 33%;">Followers</td>
					</tr>
					<tr style="width: 100%;">
						<td id="numTweetsvalue" style="width: 33%;"><a href="#" id="getTweets">{{numTweetsVal}}</a></td>
						<td id="followingvalue" style="width: 33%;"><a href="#"
							id="getFollowing"> {{numFollowingVal}}</a></td>
						<td id="followersvalue" style="width: 33%;">
						<a href="#" id="getFollowers">{{numFollowersVal}}</a></td>
					</tr>
				</table>

			</div>
		</div>
		<br> <br> <br>
		<div class="row" style="width: 100%; float: left">
			<div
				style="width: 10%; float: left; text-align: left; font-size: 20px">.
			</div>
			<div
				style="width: 20%; float: left; text-align: left; font-size: 15px">
				<b>{{username}}</b> <br>@{{handle}}<br> <br>
			</div>
		</div>
		<div style="width: 100%; float: left; border-style: none">
			<div style="width: 3%; float: left; border-style: none; height: 90%">.</div>
			<div
				style="width: 22%; float: left; border-style: ridge; height: 90%">
				<div id="aboutedit"style:"width:100%; float:"left">
					<table>
						<tr>
							<td>Birthday</td>
							<td><input type="date" style="width: 200px" id="bday"
								ng-model="bday"></input></td>
						</tr>
						<tr>
							<td>Location</td>
							<td><input type="text" style="width: 200px" id="location"
								ng-model="location" placeholder="Enter State, Country">
								</input></td>
						</tr>
						<tr>
							<td>Contact</td>
							<td><input type="text" id="contact" ng-model="contact"
								style="width: 200px"></input></td>
						</tr>
						<tr>
							<td><button id="update" ng-click="update()"
									style="margin-left: 3rem; float: right; background-color: #0084B4; height: 30px; width: 50px; float: left; margin-top: 0.25rem"
									class="btn btn-primary">Save</button></td>
							<td><button id="cancel" ng-click="cancel()"
									style="margin-left: 3rem; float: right; background-color: #0084B4; height: 30px; width: 70px; float: left; margin-top: 0.25rem"
									class="btn btn-primary">Cancel</button></td>
						</tr>

					</table>

				</div>

				<div id="about"style:"width:100%; float:"left">
					<table>
						<tr>
							<td>Birthday</td>
							<td>{{birthday}}</td>
						</tr>
						<tr>
							<td>Location</td>
							<td>{{location}}</td>
						</tr>
						<tr>
							<td>Contact</td>
							<td>{{contact}}</td>
						</tr>
						<tr>

							<td><button id="cancel" ng-click="edit()"
									style="margin-left: 3rem; float: right; background-color: #0084B4; height: 30px; width: 70px; float: left; margin-top: 0.25rem"
									class="btn btn-primary">Edit</button></td>
						</tr>

					</table>

				</div>

			</div>

			<div id="tweetDisplay" ng-model="tweetDisplay"
				style="width: 50%; margin-top: -10rem; float: left; border-style: ridge;">
				<div ng-repeat="t in ftweet"
					style="width: 100%; border-style: ridge; height: 90%; float: left; background-color: white">
					<div style="width: 100%; height: 90%">
						<img src="/images/NoImg.PNG" alt="No Image" height="40px"
							width="40px"></img> <label><a href="#">{{t.usrname}}
						</a> @ {{t.thandle}}</label>

					</div>
					<div id="dtweet" ng-model="dtweet" ng-bind-html="t.tweet"
						style="width: 100%; background-color: white">{{t.tweet}}</div>
					<div style="margin-left: 15rem">
						<a href="#"><span class="glyphicon glyphicon-retweet"></a>
					</div>
				</div>
			</div>
			<div id="followingDisplay" ng-model="followingDisplay"
				style="width: 50%; margin-top: -10rem; float: left; border-style: ridge;">
				<div ng-repeat="D in Dfollowing" 
					style="width: 100%; height: 90%; float: left">
					<div
			style="width: 90%; height: 10rem; background-color: #0084B4; float: left; margin-left: 2rem">
					</div>
					
					<div
						style="width: 90%;  height: 10rem; background-color: white; float: left; margin-left: 2rem">
							
							<div style="margin-left:12rem">{{D.usrname}}@{{D.thandle}} </div>
							<button id="follow" ng-click="follow(user.thandle)"
								style=" color: white; height: 30px; width: 80px; float: right; text-align: center; margin-right:2rem; margin-top: 0.5rem"
								class="btn btn-primary">Following</button>
					</div>
					<div
						style="width: 90%; float: left; margin-left: 3rem; margin-top: -15rem">
							<img src="/images/NoImg.PNG" alt="No Image" height="90px"
								width="90px"></img>
					</div>

				</div>	
			</div>
			<div id="followersDisplay" ng-model="followersDisplay"
				style="width: 50%; margin-top: -10rem; float: left; border-style: ridge;">
				<div ng-repeat="G in Gfollowers"
					style="width: 100%; height: 90%; float: left">
					<div
						style="width: 90%; height: 10rem; background-color: #0084B4; float: left; margin-left: 2rem">
					</div>

					<div
						style="width: 90%; height: 10rem; background-color: white; float: left; margin-left: 2rem">

						<div style="margin-left: 12rem">{{G.usrname}}@{{G.thandle}}
						</div>
						<button id="follow" ng-click="follow(G.thandle)"
							style="color: white; height: 30px; width: 80px; float: right; text-align: center; margin-right: 2rem; margin-top: 0.5rem"
							class="btn btn-primary">Follow</button>
					</div>
					<div
						style="width: 90%; float: left; margin-left: 3rem; margin-top: -15rem">
						<img src="/images/NoImg.PNG" alt="No Image" height="90px"
							width="90px"></img>
					</div>

				</div>
			</div>
			
			
			<div 
				style="width: 25%; float: right; border-style: ridge; margin-top: -10rem">
				<div
					style="width: 100%; border-style: ridge; height: 90%; float: left; background-color: white;">
					Who to follow <a href="#">View All</a>
					<div ng-repeat="user in suggestedUsers"
						style="width: 100%; border-style: ridge; height: 90%; float: left;">

						<div style="width: 20%; text-align: center; float: left">
							<img src="/images/NoImg.PNG" alt="No Image" height="50px"
								width="50px"></img>
						</div>
						<div ng-model="suggestedUname"
							style="width: 80%; text-align: left">
							{{user.uname}} @{{user.thandle}} <br>
							<button id="follow" ng-click="follow(user.thandle)"
								style="background-color: #F8FAFC; color: black; height: 30px; width: 70px; float: left; text-align: center; margin-top: 0.5rem"
								class="btn btn-primary">Follow</button>
						</div>



					</div>
				</div>



			</div>
</body>
<script>
	var app = angular.module('Loggedin', [ 'ngSanitize' ]);
	app.controller('ProfileCtrl', function($scope, $http) {
		$("#aboutedit").hide();
		$("#tweetDisplay").show();
		$("#followingDisplay").hide();
		$("#followersDisplay").hide();
		

		$http({
			method : 'GET',
			url : '/loadPage',

		}).success(function(response) {
			console.log(response);
			if (response != "Failure") {
				//display feed
				$scope.numTweetsVal = response[0].TWEETS;
				$scope.username = response[0].uname;
				$scope.numFollowersVal = response[0].FOLLOWERS;
				$scope.numFollowingVal = response[0].FOLLOWING;
				$scope.handle = response[0].thandle;
				$scope.birthday = response[0].birthday;
				$scope.location = response[0].location;
				$scope.contact = response[0].phone;
			}
		}).error(function(error) {

		});

		$http({
			method : 'GET',
			url : '/followSuggestion',

		}).success(function(response) {
			console.log(response);
			$scope.suggestedUsers = response;
		}).error(function(error) {

		});

		$http({
			method : 'GET',
			url : '/fetchTweets',

		}).success(function(response) {

			$scope.ftweet = response;

		}).error(function(error) {
			console.log(" error");
		});
		$http({
			method : 'GET',
			url : '/fetchfollowing',

		}).success(function(response) {

			$scope.Dfollowing = response;
			

		}).error(function(error) {
			console.log(" error");
		});
		
		$http({
			method : 'GET',
			url : '/fetchfollowers',

		}).success(function(response) {

			$scope.Gfollowers = response;
			

		}).error(function(error) {
			console.log(" error");
		});
		
						$scope.logout=function(){
							window.location.href='/logout';
						}
		$scope.edit = function() {
			alert("in edit function");
			$("#about").hide();
			$("#aboutedit").show();

		}
		$scope.cancel = function() {
			alert("in cancel function");
			$("#about").show();
			$("#aboutedit").hide();

		}

		
		$("#getTweets").on('click', function() {
			$("#followersDisplay").hide();
			$("#tweetDisplay").show();
			$("#followingDisplay").hide();
		});

		$("#getFollowing").on('click', function() {
			$("#followersDisplay").hide();
			$("#tweetDisplay").hide();
			$("#followingDisplay").show();
		});
		
		$("#getFollowers").on('click', function() {
			alert("hey");
			$("#followersDisplay").show();
			$("#tweetDisplay").hide();
			$("#followingDisplay").hide();
		});
		
		$scope.searchmembers=function(searchText){
			alert("searching with"+ $scope.searchText);
			//window.location.href='/searchmembers';
			$http({
								method : 'POST',
								url : '/searchmembers',
								data : {
									'searchTerm' : $scope.searchText
									
								}

							})
									.success(
											function(response) {
											if(response=="Success"){
												
													window.location.href="/searchTweets";}
												
											})
									.error(
											function(error) {
												
											});
			
		}
		
		$scope.update = function() {
			var str = ($scope.bday);
			alert(str);
			$http({
				method : 'POST',
				url : '/profileUpdate',
				data : {
					"bday" : $scope.bday,
					"contact" : $scope.contact,
					"location" : $scope.location

				}

			}).success(function(response) {
				console.log(response);
				if (response != "Failure") {
					console.log("profile inserted");

				}
			}).error(function(error) {

			});
		}
	});
</script>

</html>
